# Skill-Zero Analyzer

スキルゼロでも OK！オフ会参加者の分析を行う 4 段階システムです。

## 概要

このシステムは、オフ会参加者のデータを処理し、AI 分析を行い、美しい HTML レポートを生成するための 4 段階アプローチを採用しています：

1. **データ処理段階**: スプレッドシートデータと J 列のプロフィールテキストから自動的にプロフィール情報を収集・統合
2. **AI 分析準備段階**: 統合されたデータを基に分析用プロンプトを生成
3. **AI 分析実行段階**: 生成されたプロンプトを使用して AI 分析を実行
4. **HTML レポート生成段階**: AI 分析結果を美しい HTML レポートに変換

## システム構成

```
skill-zero-analyzer/
├── data_processor.py          # データ処理スクリプト（J列プロフィールテキストから自動収集）
├── ai_analyzer.py            # AI分析準備スクリプト
├── generate_analysis_results.py  # HTML生成スクリプト（修正済み）
├── config.py                 # 設定管理クラス
├── utils.py                  # 共通ユーティリティクラス
├── data/
│   └── prompts.md            # AI分析用プロンプトテンプレート
├── output/                   # 出力ファイル
│   ├── processed_data.json   # 統合データ
│   ├── *_analysis_prompt.txt # 各参加者の分析用プロンプト
│   ├── *_analysis_result.txt # 各参加者のAI分析結果
│   ├── *_analysis_result.html # 各参加者の分析結果HTML（美しいデザイン）
│   └── analysis_result_template.html # HTMLテンプレート
├── spreadsheet_data - form_answer.csv      # スプレッドシートデータ（J列にプロフィールテキスト）
├── requirements.txt          # Python依存関係
└── Dockerfile               # Docker設定
```

## 最新の改善点（v4.1）

### 1. **4 段階システムの完成**

- **第 1 段階**: データ処理（J 列プロフィールテキストから自動収集）
- **第 2 段階**: AI 分析準備（分析用プロンプト生成）
- **第 3 段階**: AI 分析実行（Cursor の AI で分析実行）
- **第 4 段階**: HTML レポート生成（美しいデザインで表示）

### 2. **HTML レポート生成の修正**

- `_analysis_result.txt`ファイルから正しく内容を読み取り
- 各参加者の分析結果が正確に HTML に反映
- 統一されたデザインフォーマットで美しい表示

### 3. **実際の分析結果**


### 4. **シンプルで効率的なデータ処理**

- J 列のプロフィールテキストデータを直接活用
- 複雑な Web スクレイピングを削除
- 処理速度が大幅に向上（78%のコード削減）

### 5. **明確な責任分離**

- `ProfileTextExtractor`: プロフィールテキスト抽出に特化
- `DataMerger`: データ統合機能を独立
- `DataProcessor`: メイン処理を簡潔に整理
- `ProfileAnalyzer`: プロフィール分析機能を分離
- `PromptGenerator`: プロンプト生成を独立

### 6. **設定の集中管理**

- `config.py`で全ての設定を一元管理
- CSV 列名マッピングの改善
- パス検証機能の追加

### 7. **エラーハンドリングの強化**

- 統一されたエラー処理
- 詳細なログ出力
- 型ヒントの完全対応

### 8. **美しい HTML レポート生成**

- 統一されたデザインフォーマット
- テーマカラー`#4a90e2`で統一
- 読みやすい配色（白背景、`#333333`テキスト）
- レスポンシブ対応

## 前提条件

- Docker がインストールされていること
- プロジェクトディレクトリに以下のファイルが存在すること：
  - `spreadsheet_data - form_answer.csv`（J 列にプロフィールテキストデータ）
  - `data/prompts.md`

## 使用方法

### 1. Docker イメージのビルド

```bash
docker build -t skill-zero-analyzer .
```

### 2. データ処理の実行

スプレッドシートデータと J 列のプロフィールテキストから自動的にプロフィール情報を収集・統合します：

```bash
docker run --rm -v ${PWD}:/app skill-zero-analyzer python data_processor.py
```

**実行結果**:

- `output/processed_data.json` が生成されます
- 分析対象の参加者データが統合されます
- J 列のプロフィールテキストから自動的に情報を抽出します

### 3. AI 分析の準備

統合されたデータから分析用プロンプトを生成します：

```bash
docker run --rm -v ${PWD}:/app skill-zero-analyzer python ai_analyzer.py
```

**実行結果**:

- `output/{参加者名}_analysis_prompt.txt` ファイルが生成されます
- 各参加者ごとに個別の分析プロンプトが作成されます

### 4. AI 分析の実行

生成されたプロンプトファイルを使用して Cursor の AI で分析を実行します：

1. `output/` フォルダ内の `{参加者名}_analysis_prompt.txt` ファイルを開く
2. ファイル内容を Cursor の AI に投げる
3. AI 分析結果を `{参加者名}_analysis_result.txt` として保存

### 5. HTML レポートの生成

AI 分析結果を美しい HTML レポートに変換します：

```bash
docker run --rm -v ${PWD}:/app skill-zero-analyzer python generate_analysis_results.py
```

**実行結果**:

- `output/{参加者名}_analysis_result.html` ファイルが生成されます
- 統一されたデザインフォーマットで美しいレポートが作成されます
- 各参加者の分析結果が正確に反映されます

## ファイル説明

### 入力ファイル

- **`spreadsheet_data - form_answer.csv`**: フォーム回答データ（J 列にプロフィールテキストデータ）
- **`data/prompts.md`**: AI 分析用のプロンプトテンプレート

### 出力ファイル

- **`output/processed_data.json`**: 統合された参加者データ
- **`output/{参加者名}_analysis_prompt.txt`**: 各参加者の分析用プロンプト
- **`output/{参加者名}_analysis_result.txt`**: 各参加者の AI 分析結果
- **`output/{参加者名}_analysis_result.html`**: 各参加者の分析結果 HTML レポート（美しいデザイン）
- **`output/analysis_result_template.html`**: HTML レポート用テンプレート

## 分析内容

AI 分析では以下の観点から参加者を分析します：

### プロフィール分析

- **実績・経験の分析**: やってきたこと、人から頼まれやすいこと
- **能力・特性の分析**: 得意なこと、好きなこと、苦手じゃないこと
- **改善・成長領域**: 苦手そうなこと

### オフ会情報に基づくキャリア提案

- **副業・スキル活用の可能性**: 具体的な副業提案、スキル開発ロードマップ
- **オフ会参加の戦略的価値**: マッチングポイント、参加メリット
- **リスク管理・注意点**: 気をつけるべき点、無理のない始め方

## HTML レポートの特徴

### デザイン

- **統一されたテーマカラー**: `#4a90e2`（青）で統一
- **読みやすい配色**: 白背景、`#333333`テキスト
- **上品なデザイン**: ビビッドな配色を排除した洗練された印象
- **レスポンシブ対応**: モバイルデバイスでも表示最適化

### セクション構成

1. **現状の分析**: 参加者の背景と強みの分析
2. **得意を活かせる道と副業の可能性**: 3 つの具体的な副業提案
3. **オフ会でのヒント**: オフ会参加時の活用ポイント
4. **リスク管理・注意点**: 重要な注意事項

### 具体的なアクション

各副業提案には以下の詳細情報が含まれます：

- 具体的なアクション（5 項目）
- 各アクションの期間
- 期待効果
- 収益目標
- 必要なスキル・資格

## システムの特徴

### 1. **シンプルで効率的**

- J 列のプロフィールデータを直接活用
- 不要な Web スクレイピングを削除
- 処理速度が大幅に向上

### 2. **保守しやすい構造**

- 各クラスが明確な責任を持つ
- 設定が一元管理されている
- エラーハンドリングが統一されている

### 3. **拡張性の高い設計**

- 新しいデータソースの追加が容易
- 新しい分析機能の追加が簡単
- 設定変更が容易

### 4. **美しいレポート生成**

- 統一されたデザインフォーマット
- 読みやすく上品な配色
- プロフェッショナルな印象

## トラブルシューティング

### よくある問題

1. **Docker イメージのビルドエラー**

   ```bash
   # キャッシュをクリアして再ビルド
   docker build --no-cache -t skill-zero-analyzer .
   ```

2. **ファイルが見つからないエラー**

   - 必要な入力ファイルが存在することを確認
   - ファイルパスが正しいことを確認

3. **権限エラー**
   ```bash
   # ファイルの権限を確認
   ls -la
   ```

### ログの確認

```bash
# コンテナのログを確認
docker logs <container_id>
```

## 開発者向け情報

### 依存関係

- Python 3.8+
- pandas
- python-dotenv

### 開発環境のセットアップ

```bash
# 仮想環境の作成
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate

# 依存関係のインストール
pip install -r requirements.txt
```

### テスト実行

```bash
# データ処理のテスト
python data_processor.py

# AI分析のテスト
python ai_analyzer.py

# HTML生成のテスト
python generate_analysis_results.py
```

### 設定のカスタマイズ

`config.py`で以下の設定を変更できます：

- ログレベル
- ファイルパス
- CSV 列名マッピング
- プロフィール抽出設定

## ライセンス

このプロジェクトは内部使用を目的としています。

## 更新履歴

- v4.1: HTML レポート生成の修正（\_analysis_result.txt から正しく内容を読み取り）
- v4.0: HTML レポート生成機能追加（統一されたデザイン、美しい配色）
- v3.0: リファクタリング完了（J 列プロフィールデータ活用、シンプル化、78%コード削減）
- v2.1: リファクタリング（設定集中管理、共通ユーティリティ分離、エラーハンドリング強化）
- v2.0: 2 段階システムに変更（データ処理 + AI 分析）
- v1.0: 統合システム（非推奨）

---

**注意**: このシステムは個人情報を含むため、適切なセキュリティ対策を講じてください。

## 新しい 4 段階システムが完成しました：

### ① データ処理スクリプト（data_processor.py）

```bash
# Dockerコンテナで実行
docker run --rm -v ${PWD}:/app skill-zero-analyzer python data_processor.py
```

**機能**:

- `spreadsheet_data - form_answer.csv`からデータを読み取り
- J 列のプロフィールテキストから自動的にプロフィール情報を収集
- フォームデータとプロフィールデータを統合
- `output/processed_data.json`として保存

### ②AI 分析準備スクリプト（ai_analyzer.py）

```bash
# Dockerコンテナで実行
docker run --rm -v ${PWD}:/app skill-zero-analyzer python ai_analyzer.py
```

**機能**:

- `processed_data.json`からデータを読み取り
- `prompts.md`のプロンプトを使用
- 各参加者の分析用プロンプトを`output/`フォルダに生成
- 生成されたプロンプトを Cursor の AI に投げて分析実行

### ③AI 分析の実行

1. `output/`フォルダに生成された`{名前}_analysis_prompt.txt`ファイルを開く
2. ファイル内容を Cursor の AI に投げる
3. AI 分析結果を`{名前}_analysis_result.txt`として保存

### ④HTML レポート生成（generate_analysis_results.py）

```bash
# Dockerコンテナで実行
docker run --rm -v ${PWD}:/app skill-zero-analyzer python generate_analysis_results.py
```

**機能**:

- AI 分析結果を美しい HTML レポートに変換
- 統一されたデザインフォーマットで表示
- テーマカラー`#4a90e2`で統一
- 読みやすい配色と上品なデザイン
- **修正済み**: `_analysis_result.txt`から正しく内容を読み取り

これで、データ処理から美しい HTML レポート生成まで、完全な 4 段階システムが完成しました！

## 実際の分析結果例

### さくらねこさん

- **現状**: システム提案からカスタマーサポートまで幅広い業務経験
- **提案 1**: 業務効率化コンサルタント（月額 5 万円〜年額 60 万円）
- **提案 2**: システム導入サポート専門家（月額 8 万円〜年額 100 万円）
- **提案 3**: 業務標準化アドバイザー（月額 6 万円〜年額 80 万円）

### Choco さん

- **現状**: 言語聴覚士として 20 年以上の経験を持つ医療専門家
- **提案 1**: 医療専門知識活用型副業（月額 8 万円〜年額 100 万円）
- **提案 2**: 学生指導・教育サポート（月額 6 万円〜年額 80 万円）
- **提案 3**: 医療関連情報発信・教材制作（月額 5 万円〜年額 60 万円）

各参加者に対して、その強みを活かした具体的な副業提案を提供しています。
